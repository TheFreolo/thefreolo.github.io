<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <title>Lezione5</title>
  <meta property="og:title" content="Lezione5" />
  <meta name="twitter:title" content="Lezione5" />
  <meta name="description" content="Ipotesi statistiche



Originally posted here.

">
  <meta property="og:description" content="Ipotesi statistiche



Originally posted here.

">
  <meta name="twitter:description" content="Ipotesi statistiche



Originally posted here.

">
  <meta name="author" content=""/>
  <link href='https://thefreolo.github.io/img/favicon.ico' rel='icon' type='image/x-icon'/>
  <meta property="og:image" content="https://thefreolo.github.io/media/Profile_PIC.jpg" />
  <meta name="twitter:image" content="https://thefreolo.github.io/media/Profile_PIC.jpg" />
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@TheFreolo" />
  <meta name="twitter:creator" content="@TheFreolo" />
  <meta property="og:url" content="https://thefreolo.github.io/calcolo-delle-probabilita-e-statistica-matematica/lezione5_2020/" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="Federico Reali" />

  <meta name="generator" content="Hugo 0.36.1" />
  <link rel="canonical" href="https://thefreolo.github.io/calcolo-delle-probabilita-e-statistica-matematica/lezione5_2020/" />
  <link rel="alternate" href="https://thefreolo.github.io/index.xml" type="application/rss+xml" title="Federico Reali">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css" integrity="sha384-wITovz90syo1dJWVh32uuETPVEtGigN07tkttEqPv+uR2SE/mbQcG7ATL28aI9H0" crossorigin="anonymous">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  <link rel="stylesheet" href="https://thefreolo.github.io/css/main.css" /><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" />
  <link rel="stylesheet" href="https://thefreolo.github.io/css/highlight.min.css" /><link rel="stylesheet" href="https://thefreolo.github.io/css/codeblock.css" />



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.css" integrity="sha384-h/L2W9KefUClHWaty3SLE5F/qvc4djlyR4qY3NUV5HGQBBW7stbcfff1+I/vmsHh" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/default-skin/default-skin.min.css" integrity="sha384-iD0dNku6PYSIQLyfTOpB06F2KCZJAKLOThS5HRe8b3ibhdEQ6eKsFf/EeFxdOt5R" crossorigin="anonymous">



<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-142285014-1cse', 'auto');
ga('send', 'pageview');
</script>
<script async src='//www.google-analytics.com/analytics.js'></script>

</head>

  <body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="https://thefreolo.github.io/">Federico Reali</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
        
          
            <li class="navlinks-container">
              <a class="navlinks-parent" href="javascript:void(0)">Teaching</a>
              <div class="navlinks-children">
                
                  <a href="/teachings/">Home</a>
                
                  <a href="/biostatistics/">Biostatistics</a>
                
                  <a href="/calcolo-delle-probabilita-e-statistica-matematica">Calcolo delle Probabilità e Statistica Matematica</a>
                
                  <a href="/book/index.html">Note di R (it)</a>
                
              </div>
            </li>
          
        
          
            <li>
              <a title="Publications" href="/publications/">Publications</a>
            </li>
          
        
          
            <li>
              <a title="About" href="/about/">About</a>
            </li>
          
        

        

        
      </ul>
    </div>

    <div class="avatar-container">
      <div class="avatar-img-border">
        
          <a title="Federico Reali" href="https://thefreolo.github.io/">
            <img class="avatar-img" src="https://thefreolo.github.io/media/Profile_PIC.jpg" alt="Federico Reali" />
          </a>
        
      </div>
    </div>

  </div>
</nav>




    
  
  
  




  

  <header class="header-section ">
    
    <div class="intro-header no-img">
      
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            <div class="Calcolo delle Probabilita e Statistica Matematica-heading">
              <h1>Lezione5</h1>
                
                
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>


    
<div class="container" role="main">
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
      <article role="main" class="blog-post">
        <h1 id="ipotesi-statistiche">Ipotesi statistiche</h1>

<p><img src="https://imgs.xkcd.com/comics/t_distribution.png" alt="" /></p>

<p>Originally posted <a href="https://xkcd.com/1347/">here</a>.</p>

<p></p>

<h1 id="ipotesi-statistiche-test-nb-html"><a href="/Test.nb.html">Ipotesi statistiche</a></h1>

<p>Le note riportano una breve introduzione sui test statistici con R.</p>

<h2 id="breve-esercizio">Breve esercizio</h2>

<ol>
<li>Si leggano i dati regionali della protezione civile relativi a COVID-19 al <a href="https://raw.githubusercontent.com/pcm-dpc/COVID-19/master/dati-regioni/dpc-covid19-ita-regioni.csv">link</a>. Si salvino in un opportuno dataframe.</li>
<li>Si verifichi se il valore medio di nuovi contagi tra tutte le regioni durante il mese di Aprile è statisticamente maggiore di 135 rispetto alla soglia di significatività del 99%.</li>
<li>Si ripeta separatamente l&rsquo;analisi per Piemonte e Toscana (nello stesso periodo). Si commentino i risultati.</li>
<li>Se verifichi se il valore medio dei nuovi guariti (come definiti nella scorsa lezione) in Veneto ed Emilia Romagna sono statisticamente differenti.</li>
</ol>

<h1 id="esercitazione-2">Esercitazione 2</h1>

<p>Si scarichi il dataset al <a href="https://www.dropbox.com/s/20uhunn7ci38yv6/DataL5%20%283%29.tsv?dl=1">link</a> e si eseguano le operazioni:</p>

<ol>
<li>Si importi il dataset.</li>
<li>Si crei un nuovo dataset contenente solo le righe corrispondenti alla variabile <strong>Idataset</strong> uguale all&rsquo;ultimo numero del proprio numero di matricola. Dopo aver fatto ciò, si rimuova la variabile. Le seguenti analisi si intendono su questo dataset.</li>
<li>Si analizzi la struttura del dataset, si verifichi il numero di righe e colonne contenute. Il dataset è stato letto bene? E&rsquo; tidy?</li>
<li>Si verifichi la presenza di eventuali errori nei dati e si sostituiscano con la mediana.</li>
<li>Si calcolino media, mediana, minimo, massimo e quartili e deviazione standard.</li>
<li>Si visualizzi la distribuzione delle variabili <strong>x</strong> e <strong>y</strong> e i loro box plot.</li>
<li>Si visualizzino i dati mediante uno scatterplot.</li>
</ol>

<h4 id="soluzione-sollez5-r"><a href="/SolLez5.R">Soluzione</a></h4>

<p>Il dataset completo e una discussione riguardo i dati usati per l&rsquo;esercizio sono disponibili <a href="https://www.autodeskresearch.com/publications/samestats">qui</a>.</p>

<!-- # Regressione lineare

Al [link](/Regression_2019.nb.html) è possibile trovare delle note sulla regressione.

Ricordiamo che per applicare la regressione lineare dobbiamo essere sicuri che le ipotesi siano soddisfatte. In particolare dovremo assicurarci che i residui seguano una distribuzione normale centrata in 0 e siano indipendenti. 

Alcune delle funzioni già viste possono aiutarci in questo compito.

Definire e richiamare un modello lineare in R è molto semplice. Basta infatti  utilizzare la funzione `lm()`, dove va specificata la *variabile dipendente* e il *predittore* ed i dati da usare per definire il modello.

Sebbene i modelli di *regressione multipla* siano concettualmente e praticamente più complessi, R li supporta usando la stessa funzione e la stessa notazione. In tal caso, invece che indicare un predittore, se ne indicano più usando il simbolo `+` per elencarli.

### Mtcars

Vediamo alcuni esempi usando il dataset `mtcars`.

Supponiamo di voler investigare se il consumo di carburante e il numero di cavalli seguono una relazione lineare.

Un ottimo metodo per intuire se la relazione possa essere in qualche modo lineare è quello di disegnare la variabile dipendente in funzione del predittore.

```{r}
plot(mpg ~ hp, data = mtcars)
```

Secondo i risultati della nostra analisi preliminare sembra plausibile che la relazione sia lineare. Continuiamo la nostra investigazione definendo il modello con la funzione `lm()` e visualizzando il risultato usando la ben nota funzione `summary()`.

```{r}
mtcars_reg <- lm(mpg ~ hp, data = mtcars)
summary(mtcars_reg)
```

Si può accedere ai vari elementi elencati da `summary()` usando la notazione `$`.

Tra le informazioni che fornisce summary, è presente anche il valore **R-squared** (R quadro), che è la **proporzione di varianza della variabile dipendente che viene spiegata dal predittore**. Tale valore è compreso tra 0 e 1. Valori vicino a 1 indicano un buon modello, mentre valori bassi possono indicare o che il modello non spieghi completamente/correttamente i dati, o che la varianza dei residui è molto alta. 

Una volta definito il modello, è importante visualizzare i risultati per valutarne la bontà e per capire il comportamento dei residui. In questo modo è infatti possibile verificare __quantitativamente__ (non formalmente) se i residui soddisfano le ipotesi di indipendenza (non si devono osservare dei pattern) e che la distribuzione dei quantili sia confrontabile con quella di una normale. 

I seguenti comandi permettono di visualizzare la retta di regressione, i quantili e di confrontarli con la distribuzione in quantili di una normale.

```{r}
par(mfrow = c(3,1), mar = c(2,2,1,1))
# Retta di regressione
plot(mpg ~ hp, data = mtcars)
abline(mtcars_reg$coefficients, col = "red")
# Pattern nei residui
plot(mtcars_reg$residuals, main = "Residui")
# Distribuzione in quantili 
qqnorm(mtcars_reg$residuals)
qqline(mtcars_reg$residuals)
```

#### Esercizio A
In modo analogo a quanto fato sopra, si investighi la relazione tra consumo e peso delle auto in esame.

#### Esercizio B
Si discuta un modello lineare per le variabili __x__ e __y__ di __Esercizo 1__.

## Regressione multipla

Come anticipato, se volessimo considerare una regressione multipla, e per esempio considerare come predittori sia la potenza (cavalli) che il  peso, possiamo implementare il modello in modo simile in R.

```{r}
mtcars_reg_hp_wt <- lm(mpg ~ hp + wt, data = mtcars)
summary(mtcars_reg_hp_wt)
```



# Esercitazione 1

Si scarichi il dataset al [link](https://www.dropbox.com/s/8uoacrlaeio1hy3/DataL5.tsv?dl=1) e si eseguano le operazioni:

1. Si importi il dataset.
2. Si crei un nuovo dataset contenente solo le righe corrispondenti alla variabile __Idataset__ uguale all'ultimo numero del proprio numero di matricola. Dopo aver fatto ciò, si rimuova la variabile. Le seguenti analisi si intendono su questo dataset.
3. Si analizzi la struttura del dataset, si verifichi il numero di righe e colonne contenute. Il dataset è stato letto bene? E' tidy?
4. Si verifichi la presenza di eventuali errori nei dati e si sostituiscano con la mediana. 
5. Si calcolino media, mediana, minimo, massimo e quartili e deviazione standard.
6. Si visualizzi la distribuzione delle variabili __x__ e __y__ e i loro box plot.
7. Si visualizzino i dati mediante uno scatterplot.

#### [Soluzione](/SolLez5.R)
Il dataset completo e una discussione riguardo i dati usati per l'esercizio sono disponibili [qui](https://www.autodeskresearch.com/publications/samestats).
 -->

<!-- # Esercizi

## Esercizio 1
Si importi il [dataset](https://www.dropbox.com/s/boesoonvh04nqym/Gray_Kangaroos.tsv?dl=1) ([descrizione](http://college.cengage.com/mathematics/brase/understandable_statistics/7e/students/datasets/slr/frames/frame.html)) e si analizzi la relazione tra le due variabili usando la regressione lineare. Si analizzino i risultati e si visualizzino i residui.


## Esercizio 2
Si trovi un modo adeguato per importare i dati relativi al [reddito nazionale lordo pro capite](http://docs.google.com/spreadsheet/pub?key=0ArfEDsV3bBwCdGhJcHAwanc2aFdZeXl1WTVZQnJjb1E&output=xlsx) e alla [percentuale di strade asfaltate](http://docs.google.com/spreadsheet/pub?key=0AkBd6lyS3EmpdDBKd2V5VmxkYlJuUHAtOURzUkZzNEE&output=csv) in R. Dopo aver analizzato e preparato i dataset, si usino i dati per investigare le due variabili rispetto ad un paese del G7, un paese in via di sviluppo ed un paese del terzo mondo a scelta, nel periodo dal 1990 al 2009. 
Si analizzino i dati e si visualizzino. Inoltre si usi la regressione lineare per analizzare la relazione tra le variabili. Si commentino e discutano i risultati. 

##### [Soluzione Es2](/SolEs2.R) 


## <a name="L6Ex3"></a>Esercizio 3
Usando il dataset ottenuto nell'[Esercizio 3 della lezione 5](../lezione5_2019#L5Ex3 ), si investighi usando la regressione lineare la relazione tra prodotto interno lordo e aspettativa di vita per ognuno dei continenti. Si usi la funzione `predict()` per valutare il modello su dati diversi da quelli usati per definirlo. In particolare, si valuti il modello ottenuto per l'America sui dati europei e viceversa. Si visualizzino e si discutano i risultati ottenuti, dandone anche un interpretazione.

## <a name="L6Ex4"></a>Esercizio 4
Si considerino i modelli ottenuto nell'[Esercizio 3](./#L6Ex3). Si valuti separatamente il modello ottenuto per l'America e quello l'Europa usando i dati dei paesi _Canada_, _Italy_, _Argentina_ e _Sierra Leone_ contentuti nel dataset originale. Si valutino i valori di R quadro ottenuti e si discutano i risultati.

_Suggerimento_ si usi la formulazione equivalente di R quadro:
<a href="https://www.codecogs.com/eqnedit.php?latex=R^2&space;=&space;1&space;-&space;\frac{SS_{res}}{SS_{tot}},&space;\,&space;\text{&space;dove&space;}&space;SS_{res}&space;=&space;\sum_i&space;(y_i&space;-&space;\hat{y}_i)^2&space;\text{&space;e&space;}&space;SS_{tot}&space;=&space;\sum_i&space;(y_i&space;-&space;\bar{y})^2" target="_blank"><img src="https://latex.codecogs.com/gif.latex?R^2&space;=&space;1&space;-&space;\frac{SS_{res}}{SS_{tot}},&space;\,&space;\text{&space;dove&space;}&space;SS_{res}&space;=&space;\sum_i&space;(y_i&space;-&space;\hat{y}_i)^2&space;\text{&space;e&space;}&space;SS_{tot}&space;=&space;\sum_i&space;(y_i&space;-&space;\bar{y})^2" title="R^2 = 1 - \frac{SS_{res}}{SS_{tot}}, \, \text{ dove } SS_{res} = \sum_i (y_i - \hat{y}_i)^2 \text{ e } SS_{tot} = \sum_i (y_i - \bar{y})^2" /></a>
 -->

<!-- #### [Soluzioni](/SvolgimentoEsL5.R) -->

<p> &copy; 2017-2020  Federico Reali</p>
      </article>

      
        <ul class="pager blog-pager">
          
            <li class="previous">
              <a href="https://thefreolo.github.io/calcolo-delle-probabilita-e-statistica-matematica/lezione4_2020/" data-toggle="tooltip" data-placement="top" title="Lezione4">&larr; Previous Post</a>
            </li>
          
          
        </ul>
      


      
        
        
      

    </div>
  </div>
</div>

    <footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
              <li>
                <a href="https://github.com/TheFreolo" title="GitHub">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://twitter.com/TheFreolo" title="Twitter">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://linkedin.com/in/federico-reali-9379b4116" title="LinkedIn">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
          
        </ul>
        <p class="credits copyright text-muted">
          

          
          2020

          
            &nbsp;&bull;&nbsp;
            <a href="https://thefreolo.github.io/">Federico Reali</a>
          
        </p>
        
        <p class="credits theme-by text-muted">
          <a href="https://gohugo.io">Hugo v0.36.1</a> powered &nbsp;&bull;&nbsp; Theme by <a href="https://deanattali.com/beautiful-jekyll/">Beautiful Jekyll</a> adapted to <a href="https://github.com/halogenica/beautifulhugo">Beautiful Hugo</a>
          
        </p>
      </div>
    </div>
  </div>
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.js" integrity="sha384-/y1Nn9+QQAipbNQWU65krzJralCnuOasHncUFXGkdwntGeSvQicrYkiUBwsgUqc1" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/contrib/auto-render.min.js" integrity="sha384-dq1/gEHSxPZQ7DdrM82ID4YVol9BYyU7GbWlIwnwyPzotpoc57wDw/guX8EaYGPx" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<script src="https://thefreolo.github.io/js/main.js"></script>
<script src="https://thefreolo.github.io/js/highlight.min.js"></script>
<script> hljs.initHighlightingOnLoad(); </script>
<script> $(document).ready(function() {$("pre.chroma").css("padding","0");}); </script><script> renderMathInElement(document.body); </script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.js" integrity="sha384-QELNnmcmU8IR9ZAykt67vGr9/rZJdHbiWi64V88fCPaOohUlHCqUD/unNN0BXSqy" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe-ui-default.min.js" integrity="sha384-m67o7SkQ1ALzKZIFh4CiTA8tmadaujiTa9Vu+nqPSwDOqHrDmxLezTdFln8077+q" crossorigin="anonymous"></script>
<script src="https://thefreolo.github.io/js/load-photoswipe.js"></script>






  </body>
</html>

